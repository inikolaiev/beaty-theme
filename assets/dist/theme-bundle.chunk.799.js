"use strict";(self.webpackChunkpapathemes_beautify=self.webpackChunkpapathemes_beautify||[]).push([[799],{60799:(e,t,r)=>{r.r(t),r.d(t,{default:()=>q});var i=r(42066),o=r(50469),a=r(25270),n=r(28426),s=r(99706),c=r(38268),h=r(32861),u=r(23279),d=r.n(u),l=r(8575),y=r(55282),g=r(55825),p=function(){function e(e){this.doSearch=d()(this.doSearch.bind(this),500),this.onInput=this.onInput.bind(this),this.onFormSubmit=this.onFormSubmit.bind(this),this.onClear=this.onClear.bind(this),this.onStateChange=this.onStateChange.bind(this),this.options=e,this.$body=g("body"),this.$input=g("[data-search-in-category]"),this.$form=this.$input.closest("form"),this.$clear=this.$form.find("[data-clear]").hide(),this.originalPathname=window.location.pathname,e&&e.facetedSearch&&(this.options.facetedSearch.updateViewCallback=this.updateViewFacetedSearch.bind(this)),this.bindEvents();var t=l.parse(y.Z.getUrl(),!0);t.query.q&&(this.$input.val(t.query.q),this.$clear.show(),g(window).trigger("statechange"))}var t=e.prototype;return t.destroy=function(){this.unbindEvents()},t.bindEvents=function(){this.$input.on("input",this.onInput),this.$form.on("submit",this.onFormSubmit),this.$clear.on("click",this.onClear),0===g("#facetedSearch").length&&g(window).on("statechange",this.onStateChange)},t.unbindEvents=function(){this.$input.off("input",this.onInput),this.$form.off("submit",this.onFormSubmit),this.$clear.off("click",this.onClear),g(window).off("statechange",this.onStateChange)},t.onFormSubmit=function(){return!1},t.onClear=function(e){e.preventDefault(),this.$clear.hide(),this.$input.val("").trigger("input")},t.onInput=function(e){this.doSearch(g(e.target).val())},t.onStateChange=function(){var e=this,t=y.Z.getUrl(),r=l.parse(t,!0),o=r.query.search_query||r.query.search_query_adv||r.query.q,a={template:{productListing:"category/product-listing",sidebar:"category/sidebar"},config:{category:{shop_by_price:!0}}};o&&(r.query.search_query_adv=o,delete r.query.search_query,delete r.query.q,delete r.query.category,this.options.context.categoryId?r.query["category[]"]=this.options.context.categoryId:delete r.query["category[]"],this.options.context.categorypage_search_subs&&(r.query.searchsubs="ON"),t="/search.php?"+y.Z.buildQueryString(r.query),a={template:{productListing:"supermarket/search-in-category/product-listing",sidebar:"supermarket/search-in-category/sidebar"},showMore:"search/show-more"}),this.$form.addClass("loading"),this.$body.trigger("beforerequest.searchincategory"),i.hi.getPage(t,a,(function(t,r){if(e.$form.removeClass("loading"),t)throw new Error(t);e.$body.trigger("beforeupdate.searchincategory"),r&&e.options.searchCallback&&e.options.searchCallback(r),e.$body.trigger("afterupdate.searchincategory")}))},t.doSearch=function(e){if(0===e.length){this.$clear.hide();var t=y.Z.removeParams(y.Z.getUrl(),["q","search_query","search_query_adv","category","page"]);y.Z.goToUrl(t)}else if(e.length>=3){this.$clear.show();var r=y.Z.removeParams(y.Z.getUrl(),["q","search_query","search_query_adv","page"]);r=y.Z.replaceParams(r,{q:e}),y.Z.goToUrl(r)}},t.updateViewFacetedSearch=function(){var e=this,t=this.options.facetedSearch,r=y.Z.getUrl(),o=t.requestOptions,a=l.parse(r,!0),n=a.query.q||a.query.search_query,s=["_bc_fsnf","search_query","q","sort","limit","mode","page"],c=Object.keys(a.query).filter((function(e){return-1===s.indexOf(e)}));"/search.php"===window.location.pathname&&0===c.length?(this.$input.val(""),this.$clear.hide(),r=y.Z.removeParams(r,[].concat(c,["search_query","q","_bc_fsnf"])).replace("/search.php",this.originalPathname),window.history.replaceState({},document.title,r)):n?("/search.php"===window.location.pathname&&(a.query.q=n,delete a.query.search_query,Number(a.query.category)===this.options.context.categoryId&&delete a.query.category,window.history.replaceState({},document.title,this.originalPathname+"?"+y.Z.buildQueryString(a.query))),delete a.query.q,a.query.search_query=n,a.query.category||(a.query.category=this.options.context.categoryId),r="/search.php?"+y.Z.buildQueryString(a.query),o={template:{productListing:"supermarket/search-in-category/product-listing",sidebar:"supermarket/search-in-category/sidebar"},showMore:"search/show-more"}):this.$input.val(""),g(t.options.blockerSelector).show(),this.$form.addClass("loading"),this.$body.trigger("beforerequest.searchincategory"),i.hi.getPage(r,o,(function(r,i){if(g(t.options.blockerSelector).hide(),e.$form.removeClass("loading"),r)throw new Error(r);e.$body.trigger("beforeupdate.searchincategory"),t.refreshView(i),e.$body.trigger("afterupdate.searchincategory")}))},e}(),f=r(51855),b=r(55825);function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}var q=function(e){var t,r;function o(t){var r;return(r=e.call(this,t)||this).validationDictionary=(0,s.M)(t),r}r=e,(t=o).prototype=Object.create(r.prototype),t.prototype.constructor=t,m(t,r);var u=o.prototype;return u.onReady=function(){this.context&&(this.context.show_bulk_order_mode||this.context.useBulkOrder)&&(this.bulkOrder=(0,h.Z)(this.context)),(0,a.Z)(this.context),b("#facetedSearch").length>0?this.initFacetedSearch():(this.onSortBySubmit=this.onSortBySubmit.bind(this),i.PT.on("sortBy-submitted",this.onSortBySubmit),(0,f.Z)(),"show"===this.context.categorypage_search&&b("body").on("afterupdate.searchincategory",(function(){return(0,f.Z)()}))),(0,c.Z)(),"show"===this.context.categorypage_search&&this.initSearchInCategory(),b("#categories-navList .navList-action--checkbox").on("click",(function(e){return b(e.target).toggleClass("is-selected")}))},u.destroy=function(){this.searchInCategory&&this.searchInCategory.destroy(),this.facetedSearch?this.facetedSearch.destroy():i.PT.off("sortBy-submitted",this.onSortBySubmit)},u.initSearchInCategory=function(){var e=this;this.searchInCategory=new p({context:this.context,facetedSearch:this.facetedSearch,searchCallback:function(t){b("#product-listing-container").html(t.productListing),e.bulkOrder&&e.bulkOrder.reinit(),(0,c.Z)(),b("body").triggerHandler("compareReset"),b("html, body").animate({scrollTop:0},100)}})},u.initFacetedSearch=function(){var e=this,t=this.validationDictionary,r=t.price_min_evaluation,i=t.price_max_evaluation,o=t.price_min_not_entered,a=t.price_max_not_entered,s=t.price_invalid_value,c=b("#product-listing-container"),h=b("#faceted-search-container"),u={config:{category:{shop_by_price:!0,products:{limit:this.context.categoryProductsPerPage}}},template:{productListing:"category/product-listing",sidebar:"category/sidebar"},showMore:"category/show-more"};this.facetedSearch=new n.Z(u,(function(t){c.html(t.productListing),h.html(t.sidebar),e.bulkOrder&&e.bulkOrder.reinit(),b("body").triggerHandler("compareReset"),b("html, body").animate({scrollTop:0},100)}),{validationErrorMessages:{onMinPriceError:r,onMaxPriceError:i,minPriceNotEntered:o,maxPriceNotEntered:a,onInvalidPrice:s}})},o}(o.Z)}}]);
//# sourceMappingURL=theme-bundle.chunk.799.js.map